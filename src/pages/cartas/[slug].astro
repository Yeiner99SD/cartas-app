---
import LayoutCarta from '../../layouts/LayoutCarta.astro';
import { cartas } from '../../data/cartas';

export async function getStaticPaths() {
  return cartas.map((carta) => ({
    params: { slug: carta.slug },
    props: { carta },
  }));
}

const { carta } = Astro.props;

// Importar dinÃ¡micamente los componentes
const components = await Promise.all(
  carta.components.map(async (componentName) => {
    try {
      const module = await import(`../../sections/${carta.slug}/${componentName}.astro`);
      return module.default;
    } catch (error) {
      console.error(`Error loading component ${componentName} for ${carta.slug}:`, error);
      return null;
    }
  })
);

// Filtrar componentes que se cargaron exitosamente
const validComponents = components.filter(Boolean);
---

<LayoutCarta title={carta.title}>
  <section class="min-h-screen">
    {validComponents.map((Component) => 
      <Component />
    )}
  </section>
</LayoutCarta>